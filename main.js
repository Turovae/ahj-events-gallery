!function(){"use strict";class e{constructor(e){this.element=null,this.nameEl=null,this.urlEl=null,this.btnEl=null,this.gallery=e,this.addImg=this.addImg.bind(this),this.drawUi()}drawUi(){this.element=document.createElement("form"),this.element.classList.add("form"),this.element.addEventListener("submit",this.addImg);const e=document.createElement("label");e.classList.add("form-item"),e.textContent="Название",this.element.appendChild(e),this.nameEl=document.createElement("input"),this.nameEl.classList.add("form-input"),e.appendChild(this.nameEl),this.nameEl.required="required";const t=document.createElement("label");t.classList.add("form-item"),t.textContent="Ссылка на изображение",this.element.appendChild(t),this.urlEl=document.createElement("input"),this.urlEl.classList.add("form-input"),t.appendChild(this.urlEl),this.urlEl.required="required",this.btnEl=document.createElement("button"),this.btnEl.type="submit",this.btnEl.classList.add("form-btn"),this.btnEl.textContent="Добавить",this.element.appendChild(this.btnEl)}async addImg(e){e.preventDefault();const t=this.nameEl.value,s=this.urlEl.value;try{await this.gallery.add({name:t,url:s}),this.nameEl.value="",this.urlEl.value=""}catch(e){this.createErrMsg(e.message)}}createErrMsg(e){const t=document.createElement("div");t.classList.add("error-message"),t.textContent=e,this.urlEl.insertAdjacentElement("afterend",t),setTimeout((()=>{t.remove()}),1e3)}}class t{constructor(e,t,s){this.element=null,this.name=e,this.url=t,this.removeImg=s,this.img=null,this.delete=this.delete.bind(this)}create(){this.element=document.createElement("div"),this.element.classList.add("gallery-item"),this.element.appendChild(this.img),this.img.alt=this.name,this.img.classList.add("item-img");const e=document.createElement("div");e.classList.add("item-name"),e.textContent=this.name,this.element.appendChild(e);const t=document.createElement("button");t.classList.add("item-delete"),t.textContent="X",this.element.appendChild(t),t.addEventListener("click",this.delete)}load(){return this.img=document.createElement("img"),this.img.src=this.url,new Promise(((e,t)=>{this.img.onload=()=>{this.create(),e(!0)},this.img.onerror=()=>{t(new Error("Неверный URL изображения"))}}))}delete(){this.element.remove(),this.removeImg(this)}}class s{constructor(){this.element=null,this.gallery=new Set,this.remove=this.remove.bind(this)}drawUi(){this.element=document.createElement("div"),this.element.classList.add("gallery")}async add(e){const s=new t(e.name,e.url,this.remove);try{await s.load(),this.gallery.add(s),this.redraw()}catch(e){throw new Error(e.message)}}redraw(){[...this.gallery].forEach((e=>{this.element.appendChild(e.element)}))}remove(e){this.gallery.delete(e),this.redraw()}}const i=new class{constructor(){this.element=null,this.form=null,this.gallery=null}bindToDOM(e){let t;if(t="string"==typeof e?document.querySelector(e):e,!(t instanceof HTMLElement))throw new Error("container is not HTMLElement");this.element=t}drawUi(){this.gallery=new s,this.form=new e(this.gallery),this.form.drawUi(),this.element.appendChild(this.form.element),this.gallery.drawUi(),this.element.appendChild(this.gallery.element)}};i.bindToDOM(".app"),i.drawUi(),i.gallery.add({name:"image1",url:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQRLBdorcj02q1KOF6DU8lB3tl_JhSan8kpUa8NmLT7&s"}),i.gallery.add({name:"image2",url:"https://avatars.mds.yandex.net/i?id=16bc79b44a105d90def71ad8a7516e28_l-5882901-images-thumbs&n=27&h=384&w=480"})}();